# -*- coding: utf-8 -*-
"""
Bu Python programı, Pandas kütüphanesi kullanılarak veri analizi işlemleri yapmaktadır.
Pandas Series ve DataFrame veri yapıları oluşturulup, üzerinde çeşitli işlemler uygulanmaktadır.
"""

# Gerekli kütüphaneyi içe aktarıyoruz
import pandas as pd  

# --- Pandas Series Kullanımı ---
# Tek boyutlu bir veri yapısı olan Pandas Series oluşturuyoruz
s = pd.Series([10, 20, 30, 40], index=["a", "b", "c", "d"])
# Series, listeye benzer ancak her değere özel indeks atanabilir.
print("Pandas Series:\n", s)  # Oluşturulan Series'i ekrana yazdırıyoruz.

# --- Pandas DataFrame Kullanımı ---
# Sözlük (dictionary) veri yapısı ile bir veri çerçevesi (DataFrame) oluşturuyoruz.
data = {
    "Fiyat": [45, 85, 45, 25],  # Ürün fiyatlarını içeren bir sütun
    "Satış Adedi": [5, 6, 7, 2],  # Her ürünün kaç kez satıldığını gösteren sütun
    "Kategori": ["Roman", "Bilim", "Çocuk", "Tarih"]  # Ürün kategorileri
}

# Dictionary'den bir DataFrame oluşturuyoruz.
df = pd.DataFrame(data)

# Oluşturulan DataFrame'i ekrana yazdırıyoruz.
print("\nOluşturulan DataFrame:\n", df)

# --- DataFrame hakkında bilgi alma işlemleri ---
# DataFrame'in ilk 5 satırını görüntüleyelim (bu durumda 4 satır olduğu için tümü gelir).
print("\nDataFrame'in İlk Satırları:\n", df.head())

# DataFrame'in yapısı hakkında bilgi almak için info() fonksiyonunu kullanıyoruz.
print("\nDataFrame Bilgileri:\n")
print(df.info())  # Sütun adları, veri tipleri ve eksik veri olup olmadığı gösterilir.

# DataFrame içindeki sayısal değerler için istatistiksel özet alıyoruz.
print("\nİstatistiksel Özet:\n", df.describe())

# --- Belirli Sütunları Seçme ---
# Sadece "Fiyat" ve "Kategori" sütunlarını içeren bir alt tablo oluşturuyoruz.
print("\nFiyat ve Kategori Sütunları:\n", df[["Fiyat", "Kategori"]])

# --- Filtreleme İşlemi ---
# "Fiyat" değeri 50'den büyük olan satırları filtreleyelim.
filtre = df[df["Fiyat"] > 50]  
print("\nFiyatı 50'den Büyük Olan Ürünler:\n", filtre)

# --- Yeni Bir Sütun Ekleme ---
# "Toplam Gelir" adlı yeni bir sütun ekliyoruz. (Fiyat * Satış Adedi)
df["Toplam Gelir"] = df["Fiyat"] * df["Satış Adedi"]
print("\nToplam Gelir Sütunu Eklenmiş DataFrame:\n", df)

# --- Sütun Silme İşlemi ---
# "Kategori" sütununu DataFrame'den kaldırıyoruz.
df = df.drop("Kategori", axis=1)  # axis=1 sütun silmek için kullanılır.
print("\nKategori Sütunu Silinmiş DataFrame:\n", df)

